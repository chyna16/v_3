{% extends "layout.html" %}

{% block title %} Result {% endblock %}

{% block head %}
    <link rel=stylesheet type=text/css href="../static/style.css">
    <script src="../static/d3.min.js"></script>
    <script src="../static/table.js"></script>
    <script src="../static/charts.js"></script>
    <script src="../static/interactivity.js"></script>
{% endblock %}

{% block content %}
<h1>Results for "{{repo_name}}" Repository</h1>
<h2> 
    From 
        {% if from_date!='' %} {{ from_date }}
        {% else %} Beginning 
        {% endif %}
    to
        {% if to_date!='' %} {{ to_date }}
        {% else %} Present 
        {% endif %}
</h2>

<center>
    <div id="wrapperBar" style="display: block; width: 1000px; overflow-x: scroll;"></div>
</center>

<br>
<br>

<center>
<form id="filter" style="font-size:15px">
    Column: {% for key in keys|fromjson %}
                {% if key != (keys|fromjson)[0] %}
                <input type="radio" name="key" value={{ key }}> {{ key }} 
                {% endif %}
            {% endfor %} 
    &nbsp;&nbsp;&nbsp;
    From: <input type="text" name="start" style="width:40px">
    To: <input type="text" name="end" style="width:40px">
    &nbsp;&nbsp;&nbsp;
    <input type="button" value="Filter" onclick="setFilter()">
</form>
</center>

<br>
<br>

<center>
<div class="col-md-10" style="float:none">
    <table class="table">
        <thead id="thead"></thead>
        <tbody id="tbody"></tbody>
    </table>
</div>
</center>

<script>
    var keys = {{keys|safe}}; // an array of the data type in original order
    var json_data = {{data|safe}}; // a dictionary w/ each key (data type) holding an array
    var csv_name = {{csv_name|safe}}
    var analysis = csv_name[0]
    var repo = csv_name[1]
    var keys_len = keys.length; 
    var data_len = json_data.length;

    // default filter variables
    // declared outside so that value can be changed/accessed by other functions
    var filter_key = "blank"; // if left "blank" then filter will not apply
    var filter_start;
    var filter_end;
    var filtered_json = json_data; // to be used as a filtered copy of json_data

 
    var chosen_key = "default"; // the default key represents all columns

    // the script waits until all the html content has been loaded
    // before calling the function
    // to create the default table/graph
    document.addEventListener("DOMContentLoaded", function(event) {
        createTable(json_data);
    })

</script>
{% endblock %}
